<!DOCTYPE html>
<html>
   
	
	
<head>
<meta charset="utf-8">
<title>URL.createObjectURL example</title>
<script src="hls.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/web-streams-polyfill@2.0.2/dist/ponyfill.min.js"></script>
<script src="StreamSaver.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

<script>
	window.onload = function() {
	   const xhr = new XMLHttpRequest();
   
	   
	   xhr.addEventListener("readystatechange", function () {
		 if (this.readyState === this.DONE) {
		   var data = JSON.parse(this.responseText);
		   console.log(this.responseText); 
	 
		 
   
				  for (let i = 1; i < 700; i++) {
				   var d = new Date();
					 //  const thumb = document.createElement('img');
					 //  thumb.setAttribute("id", data.results[i].username);
					  // thumb.setAttribute("class", 'class="video_banner_img');
					   //thumb.setAttribute('onclick', '');
					//   $(thumb).attr("src", 'https://cbjpeg.stream.highwebmedia.com/riw/' + data.results[i].username + '.jpg?' + d.getTime());
					   
					//   const link = document.createElement('a');
					 //  link.setAttribute('target', 'video');
					 //  link.setAttribute('href', 'https://edge18-lax.live.mmcdn.com/live-hls/amlst:' + data.results[i].username + '/playlist.m3u8');
					  // link.setAttribute("class", 'class="video_thumb');
   
					var video = document.getElementById('video');

					if (Hls.isSupported()) {
						var hls = new Hls({
						  debug: true,
						  record: true
						});
						hls.loadSource('https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8');
						hls.attachMedia(video);
						hls.on(Hls.Events.MEDIA_ATTACHED, function () {
						  video.muted = true;
						  video.play();
						});
					  }
					  
					//video.src = 'https://edge18-lax.live.mmcdn.com/live-hls/amlst:' + data.results[i].username + '/playlist.m3u8';
					 //  document.getElementById('header1').appendChild(link);
						//$(thumb).attr("src", 'https://cbjpeg.stream.highwebmedia.com/riw/' + data.results[i].username + '.jpg?' + d.getTime());
					  // link.append(thumb)
			   
				  }
			   }
		   }
	   
	   )
   
	   
		   xhr.open("GET", "https://chaturbate.com/api/public/affiliates/onlinerooms/?wm=aqAcE&client_ip=request_ip&limit=200&hd=true&gender=f&embed_video_only=1", );
		   xhr.send();
	   
	   }       
	</script>
</head>
<body>
	<button id="$start">Start</button>
    <script>
		
    // Saving a blob is as simple as the fetch example, you just get the
      // readableStream from the blob by calling blob.stream() to get a
      // readableStream and then pipe it
      $start.onclick = () => {
        const blob = new Blob(['https://edge18-lax.live.mmcdn.com/live-hls/amlst:deea_hot99/playlist.m3u8'])
        const fileStream = streamSaver.createWriteStream('bbb_strm.mp4', {
          size: blob.size // Makes the percentage visiable in the download
        })

        // One quick alternetive way if you don't want the hole blob.js thing:
        // const readableStream = new Response(
        //   Blob || String || ArrayBuffer || ArrayBufferView
        // ).body
        const readableStream = blob.stream()

        // more optimized pipe version
        // (Safari may have pipeTo but it's useless without the WritableStream)
        if (window.WritableStream && readableStream.pipeTo) {
          return readableStream.pipeTo(fileStream)
            .then((dataURL) => console.log('done writing'))
        }
consol.log(dataURL)
        // Write (pipe) manually
        window.writer = fileStream.getWriter()

        const reader = readableStream.getReader()
        const pump = () => reader.read()
          .then(res => res.done
            ? writer.close()
            : writer.write(res.value).then(pump))
			console.log(blobURL)
        pump()
      }
	  var save_btn = document.getElementById('save_btn')
	  save_btn.addEventListener('click', () => {
		try {
		  window.showOpenFilePicker();
		} catch (err) {
		  console.error(err.name, err.message);
		}
	  }); 
	</script>
<h1>GeeksforGeeks</h1>
<input type="file">
<video height="600" id="video" controls></video>
<p class="p">The URL of this image is : </p>
</body>
<script>
	var Element = document.querySelector('input');
	var video = document.querySelector('video');
	Element.addEventListener('change', function() {
	var url = URL.createObjectURL(Element.files[0]);
	video.src = url;
	console.log(ObjectURL);
	var d=document.querySelector(".p");
	d.textContent+=url;
    
});
</script>
<button id="save_btn">Save</button>
</html>